!function(t){"use strict";var e=function(e,i,n){return this.el=e,this.$el=t(e),this.options=i,this.uuid=this.$el.attr("id")?this.$el.attr("id"):n,this.state={},this.init(),this};e.prototype={init:function(){var e=this;e._load(),e.$el.find("ul").each(function(i){var n=t(this);n.attr("data-index",i),e.options.save&&e.state.hasOwnProperty(i)?(n.parent().addClass(e.options.openClass),n.show()):n.parent().hasClass(e.options.openClass)?(n.show(),e.state[i]=1):n.hide()});var i=t("<span></span>").prepend(e.options.caretHtml),n=e.$el.find("li > a");e._trigger(i,!1),e._trigger(n,!0),e.$el.find("li:has(ul) > a").prepend(i)},_trigger:function(e,i){var n=this;e.on("click",function(e){e.stopPropagation();var s=i?t(this).next():t(this).parent().next(),o=!1;if(i){var a=t(this).attr("href");o=void 0===a||""===a||"#"===a}if(s=s.length>0&&s,n.options.onClickBefore.call(this,e,s),!i||s&&o)e.preventDefault(),n._toggle(s,s.is(":hidden")),n._save();else if(n.options.accordion){var r=n.state=n._parents(t(this));n.$el.find("ul").filter(":visible").each(function(){var e=t(this),i=e.attr("data-index");r.hasOwnProperty(i)||n._toggle(e,!1)}),n._save()}n.options.onClickAfter.call(this,e,s)})},_toggle:function(e,i){var n=this,s=e.attr("data-index"),o=e.parent();if(n.options.onToggleBefore.call(this,e,i),i){if(o.addClass(n.options.openClass),e.slideDown(n.options.slide),n.state[s]=1,n.options.accordion){var a=n.state=n._parents(e);a[s]=n.state[s]=1,n.$el.find("ul").filter(":visible").each(function(){var e=t(this),i=e.attr("data-index");a.hasOwnProperty(i)||n._toggle(e,!1)})}}else o.removeClass(n.options.openClass),e.slideUp(n.options.slide),n.state[s]=0;n.options.onToggleAfter.call(this,e,i)},_parents:function(e,i){var n={},s=e.parent(),o=s.parents("ul");return o.each(function(){var e=t(this),s=e.attr("data-index");return!!s&&void(n[s]=i?e:1)}),n},_save:function(){if(this.options.save){var e={};for(var n in this.state)1===this.state[n]&&(e[n]=1);i[this.uuid]=this.state=e,t.cookie(this.options.cookie.name,JSON.stringify(i),this.options.cookie)}},_load:function(){if(this.options.save){if(null===i){var e=t.cookie(this.options.cookie.name);i=e?JSON.parse(e):{}}this.state=i.hasOwnProperty(this.uuid)?i[this.uuid]:{}}},toggle:function(e){var i=this,n=arguments.length;if(n<=1)i.$el.find("ul").each(function(){var n=t(this);i._toggle(n,e)});else{var s,o={},a=Array.prototype.slice.call(arguments,1);n--;for(var r=0;r<n;r++){s=a[r];var l=i.$el.find('ul[data-index="'+s+'"]').first();if(l&&(o[s]=l,e)){var h=i._parents(l,!0);for(var d in h)o.hasOwnProperty(d)||(o[d]=h[d])}}for(s in o)i._toggle(o[s],e)}i._save()},destroy:function(){t.removeData(this.$el),this.$el.find("li:has(ul) > a").unbind("click"),this.$el.find("li:has(ul) > a > span").unbind("click")}},t.fn.navgoco=function(i){if("string"==typeof i&&"_"!==i.charAt(0)&&"init"!==i)var n=!0,s=Array.prototype.slice.call(arguments,1);else i=t.extend({},t.fn.navgoco.defaults,i||{}),t.cookie||(i.save=!1);return this.each(function(o){var a=t(this),r=a.data("navgoco");r||(r=new e(this,n?t.fn.navgoco.defaults:i,o),a.data("navgoco",r)),n&&r[i].apply(r,s)})};var i=null;t.fn.navgoco.defaults={caretHtml:"",accordion:!1,openClass:"open",save:!0,cookie:{name:"navgoco",expires:!1,path:"/"},slide:{duration:400,easing:"swing"},onClickBefore:t.noop,onClickAfter:t.noop,onToggleBefore:t.noop,onToggleAfter:t.noop}}(jQuery);